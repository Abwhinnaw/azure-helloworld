trigger:
- master

pool:
  name: Self-Hosted-Agent

variables:
- name: globalVariable
  value: "This is root level variable"
- name: overrideGlobalVariable
  value: "ROOT" 
- name: overrideGlobalandStageVariable
  value: "Global"


stages:
- stage:
  displayName: "Stage 1"
  variables:
    stageVariable: "This is Stage 1 level variable"
    overrideGlobalVariable: "STAGE"
    overrideGlobalandStageVariable: "Stage"
  jobs:
  - job: BuildAndTest
    variables:
    - name: jobVariable
      value: "This is Job level variable in Stage 1"
    - name: sameNameVariable
      value: "This overrides pipeline variable"
    - name: overrideGlobalandStageVariable
      value: "Job"

    workspace:
      clean: all
    steps:

    - task: Bash@3
      inputs:
        targetType: 'inline'
        script: |
          # Write your commands here
          echo ${{ variables.sameNameVariable }}
          echo "globalVariable :" $(globalVariable)
          echo "stageVariable :" $(stageVariable)
          echo "jobVariable :" $(jobVariable)
          echo "jobVariable :" $(overrideGlobalVariable)
          echo "jobVariable :" $(overrideGlobalandStageVariable)
          echo "pipelineVariable :" $(sameNameVariable)

- stage:
  displayName: "Stage 2"
  variables:
    stageVariable: "This is Stage 2 level variable"
  jobs:
  - job: BuildAndTest
    variables:
    - name: jobVariable
      value: "This is Job level variable in Stage 2"

    workspace:
      clean: all
    steps:

    - task: Bash@3
      inputs:
        targetType: 'inline'
        script: |
          # Write your commands here
          echo ${{ variables.sameNameVariable }}
          echo "globalVariable :" $(globalVariable)
          echo "stageVariable :" $(stageVariable)
          echo "jobVariable :" $(jobVariable)
          echo "pipelineVariable :" $(sameNameVariable)